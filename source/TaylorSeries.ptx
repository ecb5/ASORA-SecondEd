<chapter xmlns:xi="http://www.w3.org/2001/XInclude"  xml:id="TaylorSeries">
  <title>A <q>Tayl</q> of Three Remainders</title>

  <section  xml:id="TaylorSeries-IntFormRem">
    <title>The Integral Form of the Remainder</title>

    <idx><h>Remainder of the Taylor Series</h><h>Integral Form of</h></idx>  <p>

    Now that we have a rigorous definition of the convergence of a
      sequence, let<rsq/>s apply this to Taylor series.  Recall that the
      Taylor series of a function <m>f(x)</m> expanded about the point
      <m>a</m> is given by
      <me>
        \sum_{n=0}^\infty\frac{f^{(n)}(a)}{n!}(x-a)^n=f(a)+\frac{f^{\,\prime}(a)}{1!}(x-a)+\frac{f^{\,\prime\prime}(a)}{2!}(x-a)^2+\cdots
      </me>
    </p>


    <p>
      When we say that
      <m>f(x)=\sum_{n=0}^\infty\frac{f^{(n)}(a)}{n!}(x-a)^n</m> for a
      particular value of <m>x</m>, what we mean is that the sequence of
      partial sums
      <md>
        <mrow>\amp{} \left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)_{n=0}^\infty</mrow>
        <mrow>\amp{}\ \ \ \ \ \ \ \ \ \ \ \  = \left(f(a),
        f(a)+\frac{f^{\prime}(a)}{1!}(x-a),\right. </mrow>
        <mrow>
        \amp{}\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \left.{}f(a) +\frac{f^{\prime}(a)}{1!}(x-a)+\frac{f^{\prime\prime}(a)}{2!}(x-a)^2,\ldots\right)</mrow>
      </md>
      converges to the number <m>f(x)</m>.
      Note that the index in the summation was changed to <m>j</m> to allow <m>n</m> to represent the index of the sequence of partial sums.
      As intimidating as this may look,
      bear in mind that for a fixed real number <m>x</m>,
      this is still a sequence of real numbers so,
      that saying <m>f(x)=\sum_{n=0}^\infty\frac{f^{(n)}(a)}{n!}(x-a)^n</m> means that
      <m>\limitt{n}{\infty}{\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)}=f(x)</m>
      and in the previous chapter we developed some tools to examine this phenomenon.
      In particular,
      we know that
      <m>\limitt{n}{\infty}{\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)}=f(x)</m>
      is equivalent to
      <me>
        \limit{n}{\infty}{\Biggl[f(x)-\left(\sum_{j=0}^n \frac{f^{(j)}(a)}{j!}(x-a)^j\right)\Biggr]}=0
        </me>.
    </p>

    <p> We have seen an example of this already. In <xref
    ref="prob_series-geometric"></xref> you had to show that the
    geometric series, <m>1+x+x^2+x^3+\cdots</m> converges to
    <m>\frac{1}{1-x}</m>,for <m>|x|\lt 1</m> by showing that <me>
    \limit{n}{\infty}{\Biggl[\frac{1}{1-x}-\left(\sum_{j=0}^nx^j\right)\Biggr]=0}
    </me>.
    </p>

    <p>
      For the issue at hand (convergence of a Taylor series), we don<rsq/>t
      need to analyze the series itself.  What we need to show is that
      the difference between the function and the <m>n</m>th partial
      sum converges to zero.  This difference is called the
      <term>remainder (of the Taylor series)</term>. (Why?)
    </p>

    <p>
      While it is true that the remainder is simply
      <me>
        f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)
        </me>, it is not easy to work with it in this form.
        Fortunately, a number of alternate forms of this remainder
        are available.  We will explore some of those in this chapter.
    </p>

    <p>
      <idx><h>Remainder of the Taylor Series</h><h>Integral Form of</h></idx>

      Recall  from <xref ref="TaylorsTheorem"></xref>
      from <xref ref="PowerSeriesQuestions"></xref> that,
      <md>
        <mrow>f(x)=f(a)+\frac{f^{\,\prime}(a)}{1!}(x-a)+\frac{f^{\,\prime\prime}(a)}{2!}(x-a)^2\amp{} +\cdots+\frac{f^{(n)}(a)}{n!}(x-a)^n</mrow>
        <mrow>\amp{} +\frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{t}\amp{}\amp{}</mrow>
      </md>
      or
      <men xml:id="EQUATIONIntFormRem1">
        f(x)=\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)+\frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{t}
        </men>.
        which we can        rewrite as 
        <me>
          f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)=\frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}
          </me>.

          The expression 
            <men xml:id="EQUATIONIntFormRemainder">
              \frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}
              </men> is called the
              <term>Integral Form</term> of the remainder of the Taylor series of <m>f(x)</m>.
            
    </p>
    <p>
      Clearly, the Taylor series will converge to <m>f(x)</m> exactly when
      <me>
        \limit{n}{\infty}{\left(\frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{t}
        \right)}=0 </me>.  The <xref ref="EQUATIONIntFormRemainder"
        text="custom">Integral Form</xref> of the remainder is usually
        easier to work with than the original form: 
        <me> 
          f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)
        </me>
        and we can use the <xref ref="EQUATIONIntFormRemainder"
        text="custom">Integral Form</xref> to obtain some conditions which guarantee the convergence of particular Taylor series such as the following.
    </p>

    <theorem xml:id="THEOREMTaylorSeriesBnd">
    
      <idx><h>series</h><h>Taylor<rsq/>s series</h></idx>

      <statement>
        <p>
          If there exists a real number <m>B</m> such that
          <m>|f^{(n+1)}(t)|\leq B</m> for all nonnegative integers
          <m>n</m> and for all <m>t</m> on an interval containing
          <m>a</m> and <m>x</m>, then
          <me>
            \limit{n}{\infty}{\left(\frac{1}{n!}\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}\right)}=0
          </me>
          and so
          <me>
            f(x)=\sum_{n=0}^\infty\frac{f^{(n)}(a)}{n!}(x-a)^n.{}
          </me>
        </p>
      </statement>
    </theorem>

    <p>
      In order to prove this, it might help to first prove the following.
    </p>

    <lemma xml:id="lemma_TriangleForIntegral">
      <statement>
        <p>
          If <m>f</m> and <m>\abs{f}</m> are integrable functions and <m>a\leq b</m>, then
          <me>
            \left|\int_{t=a}^bf(t)\dx{ t}\right|\leq\int_{t=a}^b|f(t)|\dx{ t}. {}
          </me>
        </p>
      </statement>
    </lemma>

    <problem>

      <idx><h>Triangle Inequalities</h><h>for Integrals</h></idx>

      <statement>
        <p>
          Prove <xref ref="lemma_TriangleForIntegral"></xref>.
        </p>
      </statement>
      <hint>
        <p>
          <m>-|f(t)|\leq f(t)\leq|f(t)|</m>.
        </p>
      </hint>
    </problem>

    <problem>

      <idx>
        <h>series</h><h>Taylor<rsq/>s series</h>
        <h><m>f^{(n)}\lt B,\forall\  n\in\NN\imp</m> Taylor series converges</h>
      </idx>

      <statement>
        <p>
          Prove <xref ref="THEOREMTaylorSeriesBnd"></xref>.  
        </p>
      </statement>
      <hint>
        <p>
          You might want to use <xref
          ref="prob_RatioTest"></xref> of <xref
          ref="Convergence"></xref>.  Also there are two
          cases to consider: <m>a\lt x</m> and <m>x\lt a</m> (the
          case <m>x=a</m> is trivial).  You will find that this is
          true in general.  This is why we will often indicate
          that <m>t</m> is between <m>a</m> and <m>x</m> as in the
          theorem.  In the case <m>x\lt a</m>, notice that
          <md>
            <mrow>\left|\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}\right|\amp =\left|(-1)^{n+1}\int_{t=x}^af^{(n+1)}(t)(t-x)^n\dx{ t}\right|</mrow>
            <mrow>\amp =\left|\int_{t=x}^af^{(n+1)}(t)(t-x)^n\dx{ t}\right|.</mrow>
          </md>
        </p>
      </hint>
    </problem>

    <problem xml:id="prob_Taylor_Series-using">
      <introduction>
        <p>
          Use <xref ref="THEOREMTaylorSeriesBnd"></xref> to prove that for any real number <m>x</m>
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            <m>\displaystyle\sin x=\sum_{n=0}^\infty\frac{(-1)^nx^{2n+1}}{(2n+1)!}</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>\displaystyle\cos x= \sum_{n=0}^\infty\frac{(-1)^nx^{2n}}{(2n)!}</m>
          </p>
        </statement>
      </task>
      <task xml:id="prob_Taylor_Series-using-c">
        <statement>
          <p>
            <m>\displaystyle e^x=\sum_{n=0}^\infty\frac{x^n}{n!}</m>
          </p>
        </statement>
      </task>
    </problem>

    <p>
      Part (c) of <xref ref="prob_Taylor_Series-using"></xref>  shows that
      the Taylor series of <m>e^x</m> expanded at zero converges to
      <m>e^x</m> for any real number <m>x</m>.  <xref
      ref="THEOREMTaylorSeriesBnd"></xref> can be used in a similar fashion
      to show that
      <me>
        e^x=\sum_{n=0}^\infty\frac{e^a(x-a)^n}{n!}
      </me>
      for any real numbers <m>a</m> and <m>x</m>.
    </p>

    <p>
      Recall that in <xref ref="CalcIn17th18thCentury"></xref> we
      showed that if we define the function <m>E(x)</m> by the power
      series <m>\sum_{n=0}^\infty\frac{x^n}{n!}</m> then
      <m>E(x+y)=E(x)E(y)</m>.  This, of course, is just the familiar
      addition property of integer exponents extended to any real
      number.  In <xref ref="CalcIn17th18thCentury"></xref> we had to
      assume that defining <m>E(x)</m> as a series was meaningful
      because we did not address the convergence of the series in that
      chapter.  Now that we know the series converges for any real
      number we see that the definition
      <me>
        f(x) = e^x = \sum_{n=0}^\infty\frac{x^n}{n!}
      </me>
      is in fact valid.
    </p>

    <!-- <aside> -->
    <!--   <title>Comment</title> -->

    <!--   <p> -->
    <!--     We can, but that proof will have to wait for a few more chapters. -->
    <!--   </p> -->
    <!-- </aside> -->
    <p>
      Assuming that we can differentiate this series term<ndash/>by<ndash/>term it
      is straightforward to show that <m>f^\prime(x) = f(x)</m>. (We
      can, but that proof will have to wait  for <xref ref="PowerSeriesRedux-UnifConv"></xref>.) 
    </p>
    <p>
      If term<ndash/>by<ndash/>term differentiation is valid we can
      use Taylor<rsq/>s formula to show that <m>e^{a+b}=e^ae^b</m>
      more elegantly than the rather cumbersome proof in <xref
      ref="eq_ExponentAdditionProperty">equation</xref>, as the
      following problem shows.
    </p>

    <problem>

      <idx><h><m>e^x</m></h><h><m>e^{a+b}=e^ae^b</m></h></idx>

      <statement>
        <p>
          Expand <m>e^x</m> about <m>a</m> using the <xref
          ref="THEOREMTaylorSeriesBnd" text="custom">Taylor series
          expansion</xref> to show that
          <me>
            e^{a+x}=e^a\cdot e^x
            </me>.
        </p>
      </statement>
    </problem>

    <p>
      <xref ref="THEOREMTaylorSeriesBnd"></xref> is a nice first step
      toward a rigorous theory of the convergence of Taylor series,
      but it is not applicable in all cases.  For example, consider
      the function <m>f(x)=\left(1+x\right)^{\frac12}</m>.  As we saw in <xref
      ref="prob_SqrtSeriesProb"></xref>, the Maclaurin (binomial)
      series for <m>\left(1+x\right)^{\frac12}</m> appears to be converging to the
      function for <m>x\in(-1,1)</m>.  While this is true, the above
      proposition does not apply. We can see this by finding a general
      formula for the derivatives of <m>f(x)=\left(1+x\right)^{\frac12}</m> as
      follows.
      <md>
        <mrow>f^\prime(x)\amp =\frac{1}{2}(1+x)^{\frac{1}{2}-1}</mrow>
        <mrow>f^{\prime\prime}(x)\amp =\frac{1}{2}\left(\frac{1}{2}-1\right)(1+x)^{\frac{1}{2}-2}</mrow>
        <mrow>f^{\prime\prime\prime}(x)\amp =\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2 \right)(1+x)^{\frac{1}{2}-3}</mrow>
        <mrow>\amp \vdots</mrow>
        <mrow>f^{(n+1)}(x)\amp =\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2\right) \cdots\left(\frac{1}{2}-n\right)(1+x)^{\frac{1}{2}-(n+1)}</mrow>
        </md>.
    </p>

    <p>
      Notice that
      <me>
        \abs{f^{(n+1)}(0)}=\frac{1}{2}\left(1-\frac{1}{2}\right)\left(2-\frac{1}{2}\right)\cdots\left(n-\frac{1}{2}\right)
        </me>.
    </p>
    
    <p>
      Since this sequence grows without bound as
      <m>n\rightarrow\infty</m>, there is no bound for all of the
      derivatives of <m>f</m> on any interval containing <m>0</m> and
      <m>x</m>, and so the hypothesis of <xref
      ref="THEOREMTaylorSeriesBnd"></xref> will never be satisfied on
      an interval containing zero.  We need a more delicate argument
      to prove that
      <me>
        \left(1+x\right)^{\frac12}=1+\frac{1}{2}x+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)}{2!}x^2+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2\right)}{3!}x^3+\cdots
      </me>
      is valid for <m>x\in(-1,1)</m>.  To accomplish that task, we
      will need to express the remainder of the Taylor series
      differently.  Fortunately there are at least two more
      forms the remainder available.
    </p>
  </section>




  <section  xml:id="TaylorSeries-LagrFormRem">
    <title>Lagrange<rsq/>s Form of the Remainder</title>

    <idx><h>Remainder of the Taylor Series</h><h>Lagrange Form of</h></idx>

    <p>
      <idx><h>Lagrange, Joseph-Louis</h></idx>

      Joseph<ndash/>Louis Lagrange 
      provided an alternate form for the remainder of a Taylor series
      in his 1797 work <pubtitle>Théorie des functions
      analytiques</pubtitle> as
      follows.
    </p>

    <theorem xml:id="thm_LagrangeRemainder">
      <title>Lagrange<rsq/>s Form of the Remainder</title>
    
      <idx><h>Remainder of the Taylor Series</h><h>Lagrange Form of</h></idx>
      <idx><h>Lagrange<rsq/>s form of the remainder</h></idx> 

      <statement>
        <p>
          Suppose <m>f</m> is a function such that
          <m>f^{(n+1)}(t)</m> is continuous on an interval containing <m>a</m> and <m>x</m>.
          Then
          <men xml:id="EQUATIONLagFormRemainder">
            f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)=\frac{f^{\, (n+1)}(c)}{(n+1)!}(x-a)^{n+1}
          </men>
          where <m>c</m> is some number between <m>a</m> and <m>x</m>.
        </p>
      </statement>
    </theorem>

    <proof>
      <p>
        Note first that <xref ref="EQUATIONLagFormRemainder"
        >equation</xref> is true when <m>x=a</m> as both sides reduce
        to <m>0</m> (in that case <m>c=x=a</m>.)
      </p>
      <p>
        We will prove the case
        where <m>a\lt x</m>; the case <m>x\lt a</m> will be an
        exercise.
        First, we already have
        <me>
          f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)=\frac{1}{n!} \int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}
        </me>
        so it suffices to show that
        <me>
          \int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}=\,\frac{f^{\,(n+1)}(c)}{n+1}(x-a)^{n+1}
        </me>
        for some <m>c</m> with <m>c\in[\,a,x]</m>.
          To this end, let
          <me>
            M=\max_{a\le t\le x}\left(f^{(n+1)}(t)\right)
          </me>
          and
          <me>
            m=\min_{a\le t\le x}\left(f^{(n+1)}(t)\right)
            </me>.
        </p>

        <p>
          Note that for all <m>t\in[\,a,x]</m>,
          we have <m>m\leq f^{(n+1)}(t)\leq M</m>.
          Since <m>x-t\geq 0</m>, this gives us
          <men xml:id="eq_LagRem1">
            m\left(x-t\right)^n\leq f^{(n+1)}(t)(x-t)^n\leq M(x-t)^n
          </men>
          and so
          <men xml:id="eq_LagRem2">
            \int_{t=a}^xm\left(x-t\right)^n\dx{ t}\leq\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}\leq \int_{t=a}^xM(x-t)^n\dx{ t}
            </men>.
        </p>

        <p>
          Computing the outside integrals, we have
          <me>
            m\int_{t=a}^x\left(x-t\right)^n\dx{ t}\leq\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}\leq M\int_{t=a}^x(x-t)^n\dx{ t}
          </me>
          <men xml:id="eq_LagRem3">
            m\frac{(x-a)^{n+1}}{n+1}\leq\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}\leq M\frac{(x-a)^{n+1}}{n+1}
          </men>
          <me>
            m\leq\frac{\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}}{\left(\frac{(x-a)^{n+1}}{n+1} \right)}\leq M
            </me>.
        </p>

        <p>
          Since
          <me>
            \frac{\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}}{\left(\frac{(x-a)^{n+1}}{n+1} \right)}
          </me>
          is a value that lies between the maximum and minimum of <m>f^{(n+1)}</m> on <m>[\,a,x]</m>,
          then by the <xref ref="IntermediateValueTheorem" text="custom">Intermediate Value Theorem</xref>,
          there must exist a number <m>c\in[\,a,x]</m> with
          <me>
            f^{(n+1)}(c)=\frac{\int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}}{\left( \frac{(x-a)^{n+1}}{n+1}\right)}
            </me>.
        </p>
        <aside>
          
          <title>The Intermediate and Extreme Value Theorems</title>

          <p>
            We have not mentioned the <xref ref="IntermediateValueTheorem" text="custom">Intermediate Value Theorem</xref> until
            now and the citation we<rsq/>ve given is from <xref
            ref="IVTandEVT"></xref> which we have not yet reached. If it
            feels like we are cheating, good. That means you feel the
            need to conclusively justify every step in a proof before
            going on to the next. This is exactly how you should feel.
          </p>
          <p>
            However, sometimes the presentation of ideas can be made
            clearer by taking them out of order. This is such a
            case. We will return to, and prove, both the <xref ref="IntermediateValueTheorem" text="custom">Intermediate</xref>
            and <xref ref="thm_EVT" text="custom">Extreme</xref> Value Theorems in <xref
            ref="IVTandEVT"></xref>.
          </p>
          <p>
            So accept them as true for now, but
            know that this proof is not concluded until the <xref ref="IntermediateValueTheorem" text="custom">Intermediate
            </xref> and  <xref ref="thm_EVT" text="custom">Extreme</xref> Value Theorems have also been proved.
          </p>

        </aside>

        <p>
          This gives us
          <me>
            \int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}=\,\frac{f^{\,(n+1)}(c)}{n+1}(x-a)^{n+1}
            </me>.
        </p>

        <p>
          And the result follows.
        </p>
    </proof>

    <problem>

      <idx><h>Lagrange<rsq/>s form of the remainder</h><h><m>x\lt a</m></h></idx>

      <statement>
        <p>
          Prove <xref ref="thm_LagrangeRemainder"></xref> for the case where <m>x\lt a</m>. 
        </p>
      </statement>
      <hint>
        <p>
          Note that
          <me>
            \int_{t=a}^xf^{(n+1)}(t)(x-t)^n\dx{ t}=(-1)^{n+1}\int_{t=x}^af^{(n+1)}(t)(t-x)^n\dx{ t}
            </me>.
        </p>
        
        <p>
          Use the same argument on this integral.  It will work
          out in the end.  Really!  You just need to keep track
          of <em>all</em> of the negatives.
        </p>
      </hint>
    </problem>

    <p>
      <idx><h>Lagrange, Joseph-Louis</h></idx>
      <idx><h>Extreme Value Theorem (EVT)</h></idx>
      <idx><h>Intermediate Value Theorem (IVT)</h></idx>

      This is not Lagrange<rsq/>s proof. In particular he did not use
      the <xref ref="EQUATIONIntFormRemainder" text="custom">Integral
      Form</xref> of the remainder.  However, this is similar to
      Lagrange<rsq/>s proof in that he also used the <xref
      ref="IntermediateValueTheorem" text="custom">Intermediate Value
      Theorem</xref> (IVT) and <xref ref="thm_EVT"
      text="custom">Extreme Value Theorem</xref> (<term>EVT</term>) much as we did
      just now.
    </p>
    <p>
      <idx><h>Lagrange, Joseph-Louis</h></idx>

      In Lagrange<rsq/>s day, these were taken to be obviously true
      for a continuous function and we have followed Lagrange<rsq/>s lead
      by assuming the <xref ref="IntermediateValueTheorem"
      text="custom">IVT</xref> and the <xref ref="thm_EVT"
      text="custom">EVT</xref>. However, in mathematics we need to
      keep our assumptions few and simple.  The <xref
      ref="IntermediateValueTheorem" text="custom">IVT</xref> and the
      <xref ref="thm_EVT" text="custom">EVT</xref> do not satisfy this
      need in the sense that both can be proved from simpler ideas.
      We will return to this in <xref ref="IVTandEVT"></xref>.
    </p>

    <p>
      Also, a word of caution about this: Lagrange<rsq/>s form of the
      remainder is <m>\frac{f^{\,(n+1)}(c)}{(n+1)!}</m>
      <m>(x-a)^{n+1}</m>, where <m>c</m> is some number between <m>a</m>
      and <m>x</m>.  The proof does not indicate what this <m>c</m>
      might be and, in fact, this <m>c</m> changes as <m>n</m> changes.
      All we know is that this <m>c</m> lies between <m>a</m> and
      <m>x</m>.  To illustrate this issue and its potential dangers,
      consider the following problem where we have a chance to compute
      the value of <m>c</m> for the function <m>f(x)=\frac{1}{1+x}</m>.
    </p>

    <problem>
      
      <idx><h>series</h><h>Geometric series</h><h>as a Taylor series</h></idx>
      <idx><h>series</h><h>Geometric series</h></idx>

      <introduction>
        <p>
          This problem investigates the Taylor series representation
          <me>
            \frac{1}{1+x}=1-x+x^2-x^3+\cdots
            </me>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            Use the identity
            <me>\frac{1-(-x)^{n+1}}{1+x}=1-x+x^2-x^3+\cdots+(-x)^n</me>
            to compute the remainder
            <me>\frac{1}{1+x}-\left(1-x+x^2-x^3+\cdots+(-x)^n\right)</me>
            exactly, in terms of <m>x</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Evaluate the remainder in part (a) when <m>x=1</m> and
            explain how this shows that the Taylor series does not
            converge to <m>\frac{1}{1+x}</m> when <m>x=1</m>.
          </p>
    </statement>
      </task>
      <task>
        <statement>
          <p>
            Compare the remainder in part (a) with the Lagrange form
            of the remainder to determine what <m>c</m> is when
            <m>x=1</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Consider the following argument: If <m>f(x)=\frac{1}{1+x}</m>, then
            <me>
              f^{(n+1)}(c)=\frac{(-1)^{n+1}(n+1)!}{(1+c)^{n+2}}
            </me>
            so the Lagrange form of the remainder when <m>x=1</m> is given by
            <me>
              \frac{(-1)^{n+1}(n+1)!}{(n+1)!(1+c)^{n+2}}=\frac{(-1)^{n+1}}{(1+c)^{n+2}}
            </me>
            where <m>c\in[\,0,1]</m>.  Observe from part (c) that
            <m>c\neq 0</m>.  Thus <m>1+c\gt1</m> and so by <xref
            ref="prob_sequences3"></xref> of <xref
            ref="Convergence"></xref>, the Lagrange remainder
            converges to <m>0</m> as <m>n\rightarrow\infty</m>.  This
            argument would suggest that the Taylor series does converge to
            <m>\frac{1}{1+x}</m> for <m>x=1</m>.  However, we know
            from part (a) that this is incorrect.  What is wrong with
            the argument?
          </p>
        </statement>
      </task>
    </problem>

    <p>
      Even though there are potential dangers in misusing the Lagrange
      form of the remainder, it is a useful form.  For example, armed
      with the Lagrange form of the remainder, we can prove the
      following theorem.
    </p>

    <theorem xml:id="thm_BinomialSeriesConverges">
    
      <idx><h>series</h><h>Binomial Series, the</h></idx>
      <idx><h>Binomial Series, the</h><h>converges on the interval <m>[0,1]</m></h></idx>

      <statement>
        <p>
          The binomial series
          <me>
            1+\frac{1}{2}x+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)}{2!}x^2+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2\right)}{3!}x^3+\cdots
          </me>
          converges to <m>\sqrt{1+x}</m> for <m>x\in[0,1]</m>.
        </p>
      </statement>
    </theorem>

    <proof>
      <p>
        First note that the binomial series is, in fact,
        the Taylor series for the function
        <m>f(x)=\sqrt{1+x}</m> expanded about <m>a=0</m>.
        If we let <m>x</m> be a fixed number with <m>0\leq x\leq 1</m>,
        then it suffices to show that the Lagrange form of the remainder converges to <m>0</m>.
        With this in mind, notice that
        <me>
          f^{(n+1)}(x)=\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\cdots\left(\frac{1}{2}-n\right)\left(1+x\right)^{\frac{1}{2}-(n+1)}
        </me>
        and so the Lagrange form of the remainder is
        <me>
          \frac{f^{(n+1)}(c)}{(n+1)!}x^{n+1}= \frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\cdots \left(\frac{1}{2}-n\right)}{(n+1)!}\frac{x^{n+1}}{(1+c)^{n+\frac{1}{2}}}
        </me>
        where <m>c</m> is some number between <m>0</m> and <m>x</m>.
        Since <m>0\leq x\leq 1</m> and <m>1+c\geq 1</m>,
        then we have <m>\frac{1}{1+c}\leq 1</m>, and so
        <md>
          <mrow>0\amp \leq \left|\frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\cdots\left(\frac{1}{2}-n\right)}{(n+1)!}\frac{x^{n+1}}{(1+c)^{n+\frac{1}{2}}}\right|</mrow>
          <mrow>\amp =\frac{\left(\frac{1}{2}\right)\left(1-\frac{1}{2}\right)\cdots\left(n-\frac{1}{2}\right)}{(n+1)!}\frac{x^{n+1}}{(1+c)^{n+\frac{1}{2}}}</mrow>
          <mrow>\amp =\frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}\right)\left(\frac{3}{2}\right)\left(\frac{5}{2}\right)\cdots\left(\frac{2n-1}{2}\right)}{(n+1)!}\left(x^{n+1}\right)\frac{1}{(1+c)^{n+\frac{1}{2}}}</mrow>
          <mrow>\amp \leq\frac{1\cdot 1\cdot 3\cdot5\cdot\,\cdots\,\cdot\left(2n-1\right)}{2^{^{n+1}}(n+1)!}</mrow>
          <mrow>\amp =\frac{1\cdot 3\cdot 5\cdot\,\cdots\,\cdot\left(2n-1\right)\cdot 1}{2\cdot4\cdot 6\cdot\,\cdots\,\cdot 2n\cdot\left(2n+2\right)}</mrow>
          <mrow>\amp =\frac{1}{2}\cdot\frac{3}{4}\cdot\frac{5}{6}\cdot\cdots\,\cdot\frac{2n-1}{2n}\cdot\frac{1}{2n+2}</mrow>
          <mrow>\amp \leq\frac{1}{2n+2}</mrow>
          </md>.
      </p>

      <p>
        Since <m>\limitt{n}{\infty}{\frac{1}{2n+2}}=0=\limitt{n}{\infty}{0}</m>,
        then by the <xref ref="thm_SqueezeTheorem" text="custom">Squeeze Theorem</xref>,

        <md>
          <mrow>
            \limit{n}{\infty}{\abs{\frac{f^{(n+1)}(c)}{(n+1)!}x^{n+1}}}=0, \amp{}\amp{}\text{ so } \amp{}\amp{}\limit{n}{\infty}{\left(\frac{f^{(n+1)}(c)}{(n+1)!}x^{n+1}\right)}=0.
          </mrow>

        </md>

      </p>

      <p>
        Thus the Taylor series
        <me>
          1+\frac{1}{2}x+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)}{2!}x^2+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2\right)}{3!}x^3+\cdots
        </me>
        converges to <m>\sqrt{1+x}</m> for <m>0\leq x\leq 1</m>.
      </p>
    </proof>

    <p>
      Unfortunately, this proof will not work for <m>-1\lt x\lt 0</m>.
      In this case, the fact that
      <m>x\leq c\leq 0</m> makes<m>\,1+c\leq 1</m>.
      Thus <m>\frac{1}{1+c}\geq 1</m> and so the inequality
      <me>
        \frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}\right)\left(\frac{3}{2}\right)\left(\frac{5}{2}\right)\cdots\left(\frac{2n-1}{2}\right)}{(n+1)!}\frac{|x|^{n+1}}{(1+c)^{n+\frac{1}{2}}}\leq\frac{1\cdot 1\cdot 3\cdot 5\cdot\,\cdots\,\cdot\left(2n-1\right)}{2^{^{n+1}}(n+1)!}
      </me>
      may not hold.
    </p>

    <problem xml:id="prob_Taylor_Series-Binomial_Series_and">

      <idx><h>series</h><h>Binomial Series, the</h><h>Binomial Series is a Taylor series</h></idx>

      <statement>
        <p>
          Show that if <m>-\frac{1}{2}\leq x\leq c\leq 0</m>, then <m>|\frac{x}{1+c}|\leq 1</m> and modify the above proof to show that the binomial series converges to <m>\sqrt{1+x}</m> for <m>x\in\left[-\frac{1}{2},0\right]</m>.
        </p>
      </statement>
    </problem>

    <p>
      To take care of the case where <m>-1\lt x\lt -\frac{1}{2}</m>,
      we will use yet another form of the remainder for Taylor series.
      However before we tackle that, we will use the <xref
      ref="thm_LagrangeRemainder" text="custom">Lagrange Form</xref>
      of the remainder to resolve a puzzle that we mentioned in <xref
      ref="PowerSeriesQuestions"></xref>.  Recall that we noticed that
      the series representation
      <me>
        \frac{1}{1+x}=1-x+x^2-x^3+\cdots
      </me>
      did not work when <m>x=1</m>,
      however we noticed that the series obtained by integrating term by term did seem to converge to the antiderivative of <m>\frac{1}{1+x}</m>.
      Specifically, we have the Taylor series
      <me>
        \ln\left(1+x\right)=x-\frac{1}{2}x^2+\frac{1}{3}x^3-\cdots
        </me>.
    </p>

    <p>
      Substituting <m>x=1</m> into this provided the convergent series <m>1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\cdots</m>.
      We made the claim that this, in fact,
      converges to <m>\ln 2</m>, but that this was not obvious.
      The Lagrange form of the remainder gives us the machinery to prove this.
    </p>

    <problem>
      
      <idx><h>Lagrange<rsq/>s form of the remainder</h><h> <m>\ln 2</m></h></idx>

      <task>
        <statement>
          <p>
            Compute the <xref ref="thm_LagrangeRemainder"
            text="custom">Lagrange Form</xref> of the remainder for
            the Maclaurin series of <m>\ln\left(1+x\right)</m>.
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            Show that when <m>x=1</m>, the Lagrange Form of the
            remainder converges to <m>0</m> and so the equation
            <me>
            \ln 2=1-\frac{1}{2}+\frac{1}{3}-\frac{1}{4}+\cdots
            </me>
            is actually correct.
          </p>
        </statement>
      </task>
    </problem>
  </section>




  <section  xml:id="TaylorSeries-CauchyFormRem">
    <title>Cauchy<rsq/>s Form of the Remainder</title>
    
    <idx><h>Remainder of the Taylor Series</h><h>Cauchy Form of</h></idx>
    <idx><h>Cauchy, Augustin</h></idx>

    <p>
      In his 1823 work,
      <foreign>Résumée des leçons données á l’ecole royale polytechnique sur le calcul infintésimal</foreign>, Augustin Cauchy
            provided another form of the remainder for Taylor series.
    </p>
    <figure>
      <caption><url
                   href="https://mathshistory.st-andrews.ac.uk/Biographies/Cauchy/"
                   >Augustin
      Cauchy</url> (1789<ndash/>1857)</caption>

      <idx><h>Cauchy, Augustin</h><h>portrait of</h></idx>
      <idx><h>Portraits</h><h>Cauchy</h></idx>

      <image width="35%" source="images/Cauchy.png" >
        <shortdescription></shortdescription>
      </image>
    </figure>

    <theorem xml:id="thm_CauchyRemainder">
      <title>Cauchy<rsq/>s Form of the Remainder</title>

      <idx><h>Remainder of the Taylor Series</h><h>Cauchy Form of</h></idx>
      <idx><h>sequences</h><h>Cauchy sequences</h><h>Cauchy<rsq/>s remainder</h></idx> 

      <statement>
        <p>
              Suppose <m>f</m> is a function such that
              <m>f^{(n+1)}(t)</m> is continuous on an interval containing <m>a</m> and <m>x</m>.
          Then
          <men xml:id="EQUATIONCauchyFormRemainder">
            f(x)-\left(\sum_{j=0}^n\frac{f^{(j)}(a)}{j!}(x-a)^j\right)=\frac{f^{\, (n+1)}(c)}{n!}(x-c)^n(x-a)
          </men>
          where <m>c</m> is some number between <m>a</m> and <m>x</m>.
        </p>
      </statement>
    </theorem>

    <problem>

      <idx><h>series</h><h>Taylor<rsq/>s series</h><h>Cauchy Remainder</h></idx>

      <statement>
        <p>
          Prove <xref ref="thm_CauchyRemainder"></xref>
          using an argument similar to the one used in the proof of <xref ref="thm_LagrangeRemainder"></xref>.
          Don<rsq/>t forget there are two cases to consider.
        </p>
      </statement>
    </problem>

    <p>
      Using Cauchy<rsq/>s form of the remainder,
      we can prove that the binomial series
      <me>
        1+\frac{1}{2}x+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)}{2!}x^2+\frac{\frac{1}{2}\left(\frac{1}{2}-1\right)\left(\frac{1}{2}-2\right)}{3!}x^3+\cdots
      </me>
      converges to <m>\sqrt{1+x}</m> for
      <m>x\in(-1,0).</m>
    </p>
    <aside>
      

      <p>   
        Strictly speaking we only need to show this for <m>x\in(-1,-1/2)
        </m>. We covered the case <m>x\in (-1/2,0)</m> in <xref ref="prob_Taylor_Series-Binomial_Series_and"></xref>. 
        
      </p>
    </aside> 

    <p>
      With this in mind,
      let <m>x</m> be a fixed number with
      <m>-1\lt x\lt 0</m> and consider that the binomial series is the Maclaurin series for the function <m>f(x)=(1+x)^{\frac{1}{2}}</m>.
      As we saw before,
      <me>
        f^{(n+1)}(t)=\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\cdots\left(\frac{1}{2}-n\right)\left(1+t\right)^{\frac{1}{2}-(n+1)}
        </me>,

        so the Cauchy form of the remainder is given by

        
        <me>
          \frac{f^{\left(n+1\right)}\left(c\right)}{n!}{\left(x-c\right)}^n\left(x-0\right)=\frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\dots
          \left(\frac{1}{2}-n\right)}{n!}\frac{{\left(x-c\right)}^n}{{\left(1+c\right)}^{n+\frac{1}{2}}}\cdot
          x
        </me> 


        where <m>c</m> is some number with <m>x\le c\le 0</m>.  Thus we have

        
        <me>
          0\le
          \left|\frac{f^{\left(n+1\right)}\left(c\right)}{n!}{\left(x-c\right)}^n\left(x-0\right)\right|=\left|\frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\dots
          \left(\frac{1}{2}-n\right)}{n!}\frac{{\left(x-c\right)}^n}{{\left(1+c\right)}^{n+\frac{1}{2}}}\cdot
          x\right|
        </me> 
    </p>
    <p>
      Notice that if <m>-1\lt x\leq c</m>,<m></m> then <m>0\lt 1+x\leq 1+c</m>.
      Thus <m>0\lt \frac{1}{1+c}\leq\frac{1}{1+x}</m> and <m>\frac{1}{\sqrt{1+c}}\leq\frac{1}{\sqrt{1+x}}</m>.
      Thus we have
      <me>
        0\leq\left|\frac{\left(\frac{1}{2}\right)\left(\frac{1}{2}-1\right)\cdots\left(\frac{1}{2}-n\right)}{n!}\frac{(x-c)^nx}{(1+c)^{n+\frac{1}{2}}}\right|\leq\left(\frac{c-x}{1+c}\right)^n\frac{|\,x|}{\sqrt{1+x}}
        </me>.
    </p>

    <problem>

      <idx><h>Binomial Series, the</h><h><m>g(c)=\frac{c-x}{1+c}</m> is increasing</h></idx>
      <idx><h><m>g(c)=\frac{c-x}{1+c}</m> is increasing on <m>[x,0]</m></h></idx>

      <statement>
        <p>
          Suppose <m>-1\lt x\leq c\leq 0</m> and consider the function <m>g(c)=\frac{c-x}{1+c}</m>.
          Show that on <m>[x,0]</m>,
          <m>g</m> is increasing and use this to conclude that for <m>-1\lt x\leq c\leq 0</m>,
          <me>
            \frac{c-x}{1+c}\leq|x|
            </me>.
        </p>

        <p>
          Use this fact to finish the proof that the binomial series converges to
          <m>\sqrt{1+x}</m> for <m>-1\lt x\lt 0</m>.
        </p>
      </statement>
    </problem>



    <problem>
      
      <idx><h>series</h><h>Taylor<rsq/>s series</h><h>drill problems</h></idx>

      <introduction>
        <p>
          Find the <xref ref="EQUATIONIntFormRemainder"
          text="custom">Integral form</xref>, <xref
          ref="EQUATIONLagFormRemainder" text="custom">Lagrange
          form</xref>, and <xref ref="EQUATIONCauchyFormRemainder"
          text="custom">Cauchy form</xref> of the remainder for Taylor
          series of the following functions expanded about the given
          values of <m>a</m>.
        </p>
      </introduction>
      <task>
        <statement>
          <p>
            <m>f(x)=e^x</m>, <m>a=0</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>f(x)=\sqrt{x}</m>, <m>a=1</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>f(x)=(1+x)^\alpha</m>, <m>a=0</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>f(x)=\frac{1}{x}</m>, <m>a=3</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>f(x)=\ln x,\ a=2</m>
          </p>
        </statement>
      </task>
      <task>
        <statement>
          <p>
            <m>f(x)=\cos x, a=\frac{\pi}{2}</m>
          </p>
        </statement>
        <!-- <hint> -->
        <!--   <p> -->
        <!--     There are two cases depending on whether <m>n</m> is odd or even. -->
        <!--   </p> -->
        <!-- </hint> -->
      </task>
    </problem>


    <p>
      The proofs of both the <xref ref="thm_LagrangeRemainder"
      text="custom">Lagrange Form</xref> and the <xref
      ref="thm_CauchyRemainder" text="custom">Cauchy Form</xref> of
      the remainder of Taylor series made use of two crucial facts
      about continuous functions.  First, we assumed the <xref
      ref="thm_EVT" text="custom">Extreme Value Theorem</xref>: Any
      continuous function on a closed bounded interval assumes its
      maximum and minimum somewhere on the interval.  Second, we
      assumed that any continuous function satisfied the <xref
      ref="IntermediateValueTheorem" text="custom">Intermediate Value
      Theorem</xref>: If a continuous function takes on two different
      values, then it must take on any value between those two values.
    </p>

    <p>
      Mathematicians in the late <m>1700</m>s and early <m>1800</m>s
      typically considered these facts to be intuitively obvious.
      This was natural since our understanding of continuity at that
      time was solely intuitive.  Intuition is a useful tool but as we
      have seen before it is also unreliable.  For example consider
      the following function
      <mdn>
        <mrow xml:id="xsin1x"> f(x)= 
        \begin{cases}
        x\sin\left(\frac{1}{x}\right),\amp \text{if } x\neq 0,\\
        0, \amp \text{ if } x=0 
        \end{cases} 
        </mrow>
        </mdn>.
    </p>

    <p>
      Is this function continuous at <m>0</m>?  Near zero its graph looks like
      this: 
    </p>

    <figure>
      <title>
      </title>
      <caption>
        The graph of       
        <m> f(x)= 
        \begin{cases}
        x\sin\left(\frac{1}{x}\right),\amp \text{if } x\neq 0 \\
        0, \amp \text{ if } x=0 
        \end{cases} 
        </m>
        near <m>0</m>.
      </caption>
      <image width="80%" source="images/Ch5fig4.png" > 
        <shortdescription></shortdescription>
      </image>
    </figure>

    <p>
      It is impossible to show in the sketch but this graph oscillates infinitely often as
      <m>x</m> nears zero.
    </p>

    <p>
      No matter what your guess may be, it is clear that it is hard to
      analyze such a function armed with only an intuitive notion of
      continuity.  We will revisit this example in the next chapter.
    </p>

    <p>
      As with convergence, continuity is more subtle than it first appears.
    </p>

    <p>
      We put convergence on solid ground by providing a completely
      analytic definition in the previous chapter.  What we need to do
      in the next chapter is provide a completely rigorous definition
      for continuity.
    </p>
  </section>




  <!--   <section  xml:id="TaylorSeries-AddProb"> -->
  <!--     <title>Additional Problems</title> -->
  <!--     <problem> -->
  <!--       <idx><h>series</h><h>Taylor<rsq/>s series</h><h>drill problems</h></idx> -->
  <!--       <introduction> -->
  <!--         <p> -->
  <!--           Find the <xref ref="EQUATIONIntFormRemainder" -->
  <!--           text="custom">Integral form</xref>, <xref -->
  <!--           ref="EQUATIONLagFormRemainder" text="custom">Lagrange -->
  <!--           form</xref>, and <xref ref="EQUATIONCauchyFormRemainder" -->
  <!--           text="custom">Cauchy form</xref> of the remainder for Taylor -->
  <!--           series for the following functions expanded about the given -->
  <!--           values of <m>\,a</m>. -->
  <!--         </p> -->
  <!--       </introduction> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=e^x</m>, <m>a=0</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--       </task> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=\sqrt{x}</m>, <m>a=1</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--       </task> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=(1+x)^\alpha</m>, <m>a=0</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--       </task> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=\frac{1}{x}</m>, <m>a=3</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--       </task> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=\ln x,\ a=2</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--       </task> -->
  <!--       <task> -->
  <!--         <statement> -->
  <!--           <p> -->
  <!--             <m>f(x)=\cos x, a=\frac{\pi}{2}</m> -->
  <!--           </p> -->
  <!--         </statement> -->
  <!--         <hint> -->
  <!--           <p> -->
  <!--             There are two cases depending on whether <m>n</m> is odd or even. -->
  <!--           </p> -->
  <!-- </hint> -->
  <!--       </task> -->
  <!--     </problem> -->
  <!--   </section> -->


</chapter>

